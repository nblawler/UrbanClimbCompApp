<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>{{ competitor.name }} · Enter Scores</title>
	<link rel="stylesheet" href="/static/app.css" />
</head>

<body>
	{# Unified nav: uses session competitor as "you", nav_active for highlight #}
	{% set viewer_id = viewer_id if viewer_id is defined else session.get('competitor_id') %}
	<nav class="container top-nav">
		<div class="nav-links">
			<a
				class="back {% if nav_active == 'login' %}active{% endif %}"
				href="/login"
			>
				Login
			</a>

			{% if viewer_id %}
				<a
					class="back {% if nav_active == 'sections' %}active{% endif %}"
					href="/competitor/{{ viewer_id }}/sections"
				>
					Enter Scores
				</a>

				<a
					class="back {% if nav_active == 'my_stats' %}active{% endif %}"
					href="/competitor/{{ viewer_id }}/stats/my"
				>
					My Stats
				</a>

				<a
					class="back {% if nav_active == 'overall_stats' %}active{% endif %}"
					href="/competitor/{{ viewer_id }}/stats/overall"
				>
					Overall Stats
				</a>
			{% endif %}

			<a
				class="back {% if nav_active == 'leaderboard' %}active{% endif %}"
				href="/leaderboard{% if viewer_id %}?cid={{ viewer_id }}{% endif %}"
			>
				Leaderboard
			</a>
		</div>
	</nav>

	<main class="container">

		<!-- Unified header: same as competitor.html -->
		<header class="comp-header">
			<h1 class="comp-name">
				<span class="comp-label">Name:</span>
				<span class="comp-value">{{ competitor.name }}</span>
			</h1>

			<div class="comp-meta-row">
				<div class="comp-pill">
					<span class="comp-pill-label">Competitor</span>
					<span class="comp-pill-value">{{ competitor.id }}</span>
				</div>

				<div class="comp-pill">
					<span class="comp-pill-label">Points</span>
					<span class="comp-pill-value" id="total-points">{{ total_points }}</span>
				</div>

				{% if position is not none %}
					<div class="comp-pill">
						<span class="comp-pill-label">Position</span>
						<span class="comp-pill-value">{{ position }}</span>
					</div>
				{% endif %}
			</div>
		</header>

		{% if not can_edit %}
			<p class="view-only-note">
				You’re viewing sections for <strong>{{ competitor.name }}</strong> in read-only mode.
				Only this competitor (or a staff member) can log climbs from their own device.
			</p>
		{% endif %}

		<section class="section-grid">
			{% for s in sections %}
				{% if can_edit %}
					<a
						href="/competitor/{{ competitor.id }}/section/{{ s.slug }}"
						class="section-btn-big"
					>
						{{ s.name }}
					</a>
				{% else %}
					<div class="section-btn-big section-btn-disabled">
						<div>{{ s.name }}</div>
						<span class="section-btn-note">
							View only – log attempts on your own competitor page.
						</span>
					</div>
				{% endif %}
			{% endfor %}
		</section>

	</main>
</body>
</html>
